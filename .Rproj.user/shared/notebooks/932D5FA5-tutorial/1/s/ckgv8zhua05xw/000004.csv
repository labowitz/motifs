"0","# 6. Tissue and organ distributions of selected profiles"
"0","diverse_df %>% dplyr::filter(class_label %in% row.names(diverse_mat) ) %>% "
"0","  select(Tissue, class_label ) %>% dplyr::filter(!Tissue %in% c('mat','endoderm')) %>% group_by(class_label,Tissue)%>% "
"0","  count  %>% "
"0","  pivot_wider(id_cols=class_label,names_from = Tissue,"
"0","              values_from= n,values_fill = 0) -> tissue_distribution"
"0",""
"0","tissue_pal<-colorRampPalette(brewer.pal(n = 9, name = 'PuRd'))"
"0","x = tissue_distribution %>% ungroup %>% select(-class_label) %>% as.matrix() "
"0","row.names(x) <- tissue_distribution$class_label"
"0","# make tissue names pretty "
"0","colnames(x)<-str_replace(string = colnames(x),pattern =""_"",replacement = ' ') %>% firstup() "
"0",""
"0","x <- x[,sort(colnames(x))]"
"0",""
"0","pheatmap(sqrt(x), treeheight_row = 20,treeheight_col = 20,"
"0","         clustering_method = 'ward.D2',col = tissue_pal(100),"
"0","         cluster_rows = F,"
"0","         cluster_cols = F,"
"0","         fontsize =12,angle_col = 45,"
"0","         height =4, width = 6) # keep this size to make it similar to the motif heatmap"
